<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Galaxy Fall: PI Edition</title>
    
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <script type="module" crossorigin src="/assets/index-CRqruh3G.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-CJBg38Gf.css">
</head>
<body>
<div id="gameContainer">
    <!-- Sprachauswahl-Bildschirm -->
    <div id="language-select-screen">
        <h1 data-translate-key="lang_select_title">SELECT LANGUAGE</h1>
        <div class="language-grid">
            <button class="lang-button" data-lang="en">English</button>
            <button class="lang-button" data-lang="de">Deutsch</button>
            <button class="lang-button" data-lang="es">Español</button>
            <button class="lang-button" data-lang="zh">中文</button>
            <button class="lang-button" data-lang="ja">日本語</button>
            <button class="lang-button" data-lang="it">Italiano</button>
        </div>
        <button class="menu-button" id="lang-back-button" data-translate-key="btn_back">Back</button>
    </div>

    <!-- Haupt-UI des Spiels -->
    <div id="ui-panel">
        <div class="left-stats">
            <div id="mobile-pause-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                    <rect x="25" y="25" width="15" height="50" fill="currentColor"/>
                    <rect x="60" y="25" width="15" height="50" fill="currentColor"/>
                </svg>
            </div>
            <div class="ui-item"><span data-translate-key="score">Score</span>: <span id="score">0</span></div>
            <div class="ui-item" id="coin-display">
                <img id="coin-icon" src="" alt="Coins"/>: <span id="coins">0</span>
            </div>
        </div>
        <div class="right-stats">
            <div class="ui-item" id="energy-display">
                <div id="energy-bar-container"><div id="energy-bar"></div></div>
            </div>
        </div>
    </div>
    
    <div id="ui-panel-bottom">
        <div class="left-stats">
            <div class="ui-item" id="lives-display"></div>
            <div class="ui-item" id="weapon-tier-display"></div>
        </div>
        <div class="right-stats">
            <div class="ui-item">
                <span data-translate-key="level">Level</span>: <span id="level">1</span>
            </div>
        </div>
    </div>
    
    <canvas id="gameCanvas" width="800" height="750"></canvas>
    
    <div id="bottom-ui-container">
        <div id="special-inventory"></div>
        <div id="ultra-inventory"></div>
    </div>
    
    <div id="level-display-container">
        <!-- Dieser Container wird nicht mehr verwendet, aber aus Kompatibilitätsgründen beibehalten -->
    </div>

    <div id="weapon-status"></div>
    
    <!-- Menü-Container (für Pause und Hauptmenü) -->
    <div id="menu-container" style="display: none;">
        <div class="menu-header"><h1 data-translate-key="main_menu_title">GALAXY FALL</h1></div>
        <div class="menu-tabs">
            <button class="tab-button active" id="tab-spiel" data-translate-key="tab_spiel">Spiel</button>
            <button class="tab-button" id="tab-galerie" data-translate-key="tab_galerie">Galerie</button>
            <button class="tab-button" id="tab-arsenal" data-translate-key="tab_arsenal">Arsenal</button>
            <button class="tab-button" id="tab-gegner" data-translate-key="tab_gegner">Gegner</button>
            <button class="tab-button" id="tab-rangliste" data-translate-key="tab_rangliste">Rangliste</button>
            <button class="tab-button" id="tab-einstellungen" data-translate-key="tab_einstellungen">Einstellungen</button>
        </div>
        
        <div class="menu-content">
            <div id="spiel-view" class="tab-pane active">
                 <button class="menu-button" id="resume-button" data-translate-key="btn_resume">Fortsetzen</button>
                 <button class="menu-button" id="shop-button" data-translate-key="btn_shop">Shop</button>
                 <button class="menu-button" id="restart-button" data-translate-key="btn_start_game">Spiel starten</button>
                 <button class="menu-button" id="exit-button" data-translate-key="btn_exit">SPIEL BEENDEN</button>
                 <button class="menu-button" id="quit-button" data-translate-key="btn_quit">Zum Hauptmenü</button>
                 <div id="menu-highscore">
                    <span data-translate-key="highscore">Highscore</span>: <span id="highscore">0</span>
                 </div>
            </div>
            <div id="galerie-view" class="tab-pane">
                 <div class="info-panel" id="galerie-list">
                    <!-- Inhalt wird dynamisch von populateGalerie() in index.tsx gefüllt -->
                 </div>
            </div>
            <div id="arsenal-view" class="tab-pane">
                 <div class="info-panel" id="arsenal-list"></div>
            </div>
            <div id="gegner-view" class="tab-pane">
                 <div class="info-panel" id="gegner-list"></div>
            </div>
            <div id="rangliste-view" class="tab-pane">
                 <div class="info-panel" id="leaderboard-content">
                    <!-- Inhalt wird per JavaScript geladen -->
                 </div>
            </div>
            <div id="einstellungen-view" class="tab-pane">
                <div class="info-panel">
                    <div class="settings-panel">
                        <div class="setting-item">
                            <span data-translate-key="settings_language_label">Sprache</span>
                            <button class="menu-button" id="toggle-language">Deutsch</button>
                        </div>
                        <div class="setting-item">
                            <span data-translate-key="settings_volume_label">Lautstärke</span>
                            <input type="range" id="volume-master" min="0" max="1" step="0.1">
                        </div>
                        <div class="setting-item">
                            <span data-translate-key="settings_music_label">Musik</span>
                            <button class="menu-button" id="toggle-music">AN</button>
                        </div>
                        <div class="setting-item">
                            <span data-translate-key="settings_sfx_label">SFX</span>
                            <button class="menu-button" id="toggle-sfx">AN</button>
                        </div>
                        <div class="setting-item">
                            <span data-translate-key="settings_particles_label">Partikel</span>
                            <button class="menu-button" id="toggle-particles">HOCH</button>
                        </div>
                        <div class="setting-item">
                            <span data-translate-key="settings_shake_label">Bildwackeln</span>
                            <button class="menu-button" id="toggle-shake">AN</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CONTAINER FÜR DIE SPIELMODUS-AUSWAHL -->
    <div id="mode-select-container" style="display: none;">
        <div class="menu">
            <div class="menu-header">
                <h1 data-translate-key="mode_select_title">Choose Mode</h1>
            </div>
            <div class="menu-content" style="flex-direction: column; gap: 15px; padding: 20px;">
                <button id="select-campaign-button" class="menu-button" data-translate-key="btn_campaign">Campaign</button>
                <button id="select-endless-button" class="menu-button" data-translate-key="btn_endless">Endless</button>
            </div>
        </div>
    </div>

    <!-- Container für den Game-Over-Bildschirm -->
    <div id="game-over-container" style="display: none;">
        <div class="menu">
            <div class="menu-header">
                <h1 data-translate-key="game_over_title">Game Over</h1>
            </div>
            <div class="final-score-container">
                <span data-translate-key="game_over_final_score">Final Score</span>: <span id="final-score">0</span>
            </div>
            <button class="menu-button" id="restart-from-gameover-button" data-translate-key="btn_restart">Restart</button>
            <button class="menu-button" id="quit-from-gameover-button" data-translate-key="btn_quit_to_menu">Quit to Menu</button>
        </div>
    </div>

    <!-- ÜBERARBEITETER SHOP-CONTAINER -->
    <div id="shop-container" style="display: none;">
        <div class="shop-menu">
            <!-- Header mit Titel, Münzen und Pi-Anzeige -->
            <div class="shop-header">
                <h1 data-translate-key="shop_title">Arsenal-Shop</h1>
                <div id="shop-coin-display">
                    <img id="shop-coin-icon" src="" alt="Coins"/>
                    <span id="shop-coins">0</span>
                </div>
                <div id="pi-user-display" style="display: none;">
                    <span data-translate-key="connected_as">Verbunden als</span>: <span id="pi-username"></span>
                </div>
            </div>

            <!-- Tab-Navigation für die Shop-Kategorien -->
            <div id="shop-tabs" class="menu-tabs">
                <button class="tab-button active" data-tab="permanent" data-translate-key="shop_tab_permanent">Upgrades</button>
                <button class="tab-button" data-tab="consumable" data-translate-key="shop_tab_consumable">Verbrauch</button>
                <button class="tab-button" data-tab="skin" data-translate-key="shop_tab_skins">Skins</button>
                <button class="tab-button" data-tab="cosmetic" data-translate-key="shop_tab_cosmetic">Optik</button>
                <button class="tab-button" data-tab="pi_bundle" data-translate-key="shop_tab_pi_bundle">Pi Münzen</button>
            </div>

            <!-- Container für die Inhalte der Tabs -->
            <div id="shop-content" class="menu-content">
                <!-- Die Inhalte werden hier dynamisch per JavaScript eingefügt -->
            </div>

            <!-- Zurück-Button am unteren Rand -->
            <button class="menu-button" id="shop-back-button" data-translate-key="btn_back">Zurück</button>
        </div>
    </div>

    <!-- Container für den "Goodbye"-Bildschirm (nur für Mobilgeräte) -->
    <div id="exit-screen" style="display: none;">
        <div class="menu">
            <h1 data-translate-key="exit_title">Bis bald!</h1>
            <p data-translate-key="exit_message">Du kannst diesen Tab jetzt sicher schließen.</p>
        </div>
    </div>

</div>

<!-- Pi Network SDK Integration -->
<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<script>
    // GEÄNDERT: Sandbox auf 'true' für Entwicklung und Tests. Für die Live-Version auf 'false' stellen.
    Pi.init({ version: "2.0", sandbox: true });
</script>

<!-- Das Skript wird als Modul geladen, um 'import' zu ermöglichen -->
</body>
</html>